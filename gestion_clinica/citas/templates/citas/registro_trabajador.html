<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Registro de Trabajador</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" crossorigin="anonymous" referrerpolicy="no-referrer" />
    <style>
    body { background: white; margin: 0; font-family: system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, Noto Sans, Helvetica, Arial; color: #0f172a; }
    .wrap { min-height: 100vh; display: grid; place-items: center; padding: 24px; }
    .card { width: 100%; max-width: 940px; background: #ffffff; border: 1px solid #e2e8f0; border-radius: 16px; box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3); }
    .card-header { padding: 24px; border-bottom: 1px solid #e2e8f0; display: flex; align-items: center; gap: 12px; background: linear-gradient(135deg, #3b82f6, #2563eb); color: white; border-radius: 16px 16px 0 0; }
    .card-header h1 { font-size: 1.5rem; margin: 0; font-weight: 700; color: white; }
    .card-body { padding: 24px; }
    .section-box { background: #eff6ff; border: 1px solid #93c5fd; border-radius: 8px; padding: 20px; margin-bottom: 24px; }
    .section-title { margin: 0 0 16px 0; color: #1e40af; font-size: 1.125rem; font-weight: 700; display: flex; align-items: center; gap: 8px; }
    .grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(240px, 1fr)); gap: 16px; }
    .label { display: block; margin-bottom: 6px; font-weight: 600; color: #334155; font-size: 0.9rem; }
    .error { color: #b91c1c; font-size: .85rem; margin-top: 4px; }
    .help { color: #64748b; font-size: .8rem; margin-top: 4px; }
    .actions { display: flex; gap: 12px; justify-content: flex-end; margin-top: 8px; }
    .btn { display: inline-flex; align-items: center; gap: 8px; padding: 12px 20px; border-radius: 8px; text-decoration: none; font-weight: 600; border: none; cursor: pointer; transition: all 0.2s ease; }
    .btn-secondary { background: #6b7280; color: white; }
    .btn-secondary:hover { background: #4b5563; transform: translateY(-1px); }
    .btn-success { background: linear-gradient(135deg, #3b82f6, #2563eb); color: white; }
    .btn-success:hover { background: linear-gradient(135deg, #2563eb, #1d4ed8); transform: translateY(-2px); box-shadow: 0 4px 12px rgba(59, 130, 246, 0.3); }
    .footer { padding: 16px 24px 24px; display: flex; justify-content: space-between; align-items: center; color: #64748b; font-size: 0.9rem; }
    input.form-control, select.form-control { width: 100%; padding: 10px 12px; border: 2px solid #e2e8f0; border-radius: 8px; font-size: 0.95rem; background: #ffffff; color: #0f172a; transition: all 0.2s ease; }
    input.form-control:focus, select.form-control:focus { outline: none; border-color: #3b82f6; box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.12); }
    @media (max-width: 640px) { .card { border-radius: 10px; } .card-header, .card-body { padding: 16px; } }
    </style>
    {% load static %}
    <link rel="icon" href="{% static 'favicon.ico' %}">
  </head>
  <body>
  <div class="wrap">
    <div class="card">
      <div class="card-header">
        <i class="fas fa-user-plus"></i>
        <h1>Registro de Trabajador</h1>
      </div>
      <div class="card-body">
        {% if messages %}
            {% for message in messages %}
                <div style="background: {% if message.tags == 'error' %}#fee2e2{% else %}#d1fae5{% endif %}; color: {% if message.tags == 'error' %}#991b1b{% else %}#065f46{% endif %}; padding: 14px; border-radius: 10px; margin-bottom: 20px; font-size: 14px; border-left: 4px solid {% if message.tags == 'error' %}#dc2626{% else %}#10b981{% endif %}; text-align: left;">
                    <i class="fas {% if message.tags == 'error' %}fa-exclamation-circle{% else %}fa-check-circle{% endif %}" style="margin-right: 8px;"></i>
                    {{ message }}
                </div>
            {% endfor %}
        {% endif %}
        <form method="POST" novalidate>
        {% csrf_token %}

        <!-- Datos de acceso -->
        <div class="section-box">
            <h3 class="section-title">
                <i class="fas fa-lock"></i> Datos de Acceso
            </h3>

            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(240px, 1fr)); gap: 16px;">
                <div>
                    <label style="display: block; margin-bottom: 6px; font-weight: 500; color: #374151;">Usuario *</label>
                    {{ form.username }}
                    {% if form.username.errors %}
                        <div style="color: #b91c1c; font-size: .85rem; margin-top: 4px;">{{ form.username.errors|striptags }}</div>
                    {% endif %}
                    {% if form.username.help_text %}
                        <div style="color: #64748b; font-size: .8rem; margin-top: 4px;">{{ form.username.help_text }}</div>
                    {% endif %}
                </div>
                <div>
                    <label style="display: block; margin-bottom: 6px; font-weight: 500; color: #374151;">Email *</label>
                    {{ form.email }}
                    {% if form.email.errors %}
                        <div style="color: #b91c1c; font-size: .85rem; margin-top: 4px;">{{ form.email.errors|striptags }}</div>
                    {% endif %}
                </div>
                <div>
                    <label style="display: block; margin-bottom: 6px; font-weight: 500; color: #374151;">Contraseña *</label>
                    {{ form.password1 }}
                    {% if form.password1.errors %}
                        <div style="color: #b91c1c; font-size: .85rem; margin-top: 4px;">{{ form.password1.errors|striptags }}</div>
                    {% endif %}
                    {% if form.password1.help_text %}
                        <div style="color: #64748b; font-size: .8rem; margin-top: 4px;">{{ form.password1.help_text }}</div>
                    {% endif %}
                </div>
                <div>
                    <label style="display: block; margin-bottom: 6px; font-weight: 500; color: #374151;">Confirmar Contraseña *</label>
                    {{ form.password2 }}
                    {% if form.password2.errors %}
                        <div style="color: #b91c1c; font-size: .85rem; margin-top: 4px;">{{ form.password2.errors|striptags }}</div>
                    {% endif %}
                    {% if form.password2.help_text %}
                        <div style="color: #64748b; font-size: .8rem; margin-top: 4px;">{{ form.password2.help_text }}</div>
                    {% endif %}
                </div>
            </div>
        </div>

        <!-- Datos personales -->
        <div class="section-box">
            <h3 class="section-title">
                <i class="fas fa-user"></i> Datos Personales
            </h3>

            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(240px, 1fr)); gap: 16px;">
                <div>
                    <label style="display: block; margin-bottom: 6px; font-weight: 500; color: #374151;">Nombre *</label>
                    {{ form.first_name }}
                    {% if form.first_name.errors %}
                        <div style="color: #b91c1c; font-size: .85rem; margin-top: 4px;">{{ form.first_name.errors|striptags }}</div>
                    {% endif %}
                </div>
                <div>
                    <label style="display: block; margin-bottom: 6px; font-weight: 500; color: #374151;">Apellido *</label>
                    {{ form.last_name }}
                    {% if form.last_name.errors %}
                        <div style="color: #b91c1c; font-size: .85rem; margin-top: 4px;">{{ form.last_name.errors|striptags }}</div>
                    {% endif %}
                </div>
                <div style="grid-column: 1 / -1;">
                    <label style="display: block; margin-bottom: 6px; font-weight: 500; color: #374151;">Nombre Completo *</label>
                    {{ form.nombre_completo }}
                    {% if form.nombre_completo.errors %}
                        <div style="color: #b91c1c; font-size: .85rem; margin-top: 4px;">{{ form.nombre_completo.errors|striptags }}</div>
                    {% endif %}
                </div>
                <div>
                    <label style="display: block; margin-bottom: 6px; font-weight: 500; color: #374151;">Teléfono *</label>
                    {{ form.telefono }}
                    {% if form.telefono.errors %}
                        <div style="color: #b91c1c; font-size: .85rem; margin-top: 4px;">{{ form.telefono.errors|striptags }}</div>
                    {% endif %}
                </div>
                <div>
                    <label style="display: block; margin-bottom: 6px; font-weight: 500; color: #374151;">Rol *</label>
                    {{ form.rol }}
                    {% if form.rol.errors %}
                        <div style="color: #b91c1c; font-size: .85rem; margin-top: 4px;">{{ form.rol.errors|striptags }}</div>
                    {% endif %}
                </div>
            </div>
        </div>

        <!-- Datos específicos Dentista -->
        <div id="dentista-extra" style="display: none; background: #ecfeff; border: 1px solid #a5f3fc; border-radius: 8px; padding: 20px; margin-bottom: 24px;">
            <h3 style="margin: 0 0 16px 0; color: #0c4a6e; font-size: 1.125rem; font-weight: 600;">
                <i class="fas fa-tooth"></i> Datos de Dentista
            </h3>

            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(240px, 1fr)); gap: 16px;">
                <div>
                    <label style="display: block; margin-bottom: 6px; font-weight: 500; color: #0c4a6e;">Especialidad</label>
                    {{ form.especialidad }}
                    {% if form.especialidad.errors %}
                        <div style="color: #b91c1c; font-size: .85rem; margin-top: 4px;">{{ form.especialidad.errors|striptags }}</div>
                    {% endif %}
                </div>
                <div>
                    <label style="display: block; margin-bottom: 6px; font-weight: 500; color: #0c4a6e;">Número de Colegio</label>
                    {{ form.numero_colegio }}
                    {% if form.numero_colegio.errors %}
                        <div style="color: #b91c1c; font-size: .85rem; margin-top: 4px;">{{ form.numero_colegio.errors|striptags }}</div>
                    {% endif %}
                </div>
            </div>
        </div>

        <!-- Botones -->
        <div class="actions">
            <a href="{% url 'login' %}" class="btn btn-secondary"><i class="fas fa-arrow-left"></i> Volver al login</a>
            <button type="submit" class="btn btn-success"><i class="fas fa-user-check"></i> Registrarse</button>
        </div>
        </form>
      </div>
      <div class="footer">
        <span>Clínica Dental · Registro</span>
        <a href="{% url 'login' %}" style="text-decoration:none; color:#3b82f6;"><i class="fas fa-sign-in-alt"></i> Iniciar sesión</a>
      </div>
    </div>
  </div>
  <script>
document.addEventListener('DOMContentLoaded', function() {
    const rolSelect = document.getElementById('{{ form.rol.id_for_label }}') || document.querySelector('select[name="rol"]');
    const dentistaExtra = document.getElementById('dentista-extra');
    function toggleDentista() {
        if (!rolSelect) return;
        dentistaExtra.style.display = rolSelect.value === 'dentista' ? 'block' : 'none';
    }
    if (rolSelect) {
        rolSelect.addEventListener('change', toggleDentista);
        toggleDentista();
    }
});
  </script>
  </body>
  </html>